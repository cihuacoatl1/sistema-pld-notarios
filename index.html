<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema PLD - Notarios</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Sistema de Login -->
    <div id="login-system" class="login-container">
        <h2 class="login-title">
            <i class="fas fa-landmark"></i>
            Sistema PLD - Acceso Notarios
        </h2>
        <div class="form-group">
            <label for="username">Usuario:</label>
            <input type="text" id="username" placeholder="Ingrese su usuario">
        </div>
        <div class="form-group">
            <label for="password">Contraseña:</label>
            <input type="password" id="password" placeholder="Ingrese su contraseña">
        </div>
        <button id="login-btn" class="btn-success">
            <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
        </button>
        <div id="login-error" class="alert alert-danger hidden">
            <i class="fas fa-exclamation-circle"></i> Credenciales incorrectas
        </div>
    </div>

    <!-- Sistema Principal (oculto inicialmente) -->
    <div id="main-system" class="hidden">
        <header>
            <div class="container header-content">
                <div class="logo">
                    <i class="fas fa-landmark"></i>
                    <span>Sistema PLD - Notarios</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar">JP</div>
                    <span id="user-display">Notario: Juan Pérez</span>
                    <button class="logout-btn" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </button>
                </div>
            </div>
        </header>

        <nav>
            <div class="container">
                <ul class="nav-menu">
                    <li><a href="#" class="nav-link active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" class="nav-link" data-section="nueva-operacion"><i class="fas fa-file-contract"></i> Nueva Operación</a></li>
                    <li><a href="#" class="nav-link" data-section="operaciones"><i class="fas fa-clipboard-list"></i> Operaciones</a></li>
                    <li><a href="#" class="nav-link" data-section="clientes"><i class="fas fa-users"></i> Clientes</a></li>
                    <li><a href="#" class="nav-link" data-section="configuracion"><i class="fas fa-cog"></i> Configuración</a></li>
                </ul>
            </div>
        </nav>

        <main class="container">
            <!-- Dashboard -->
            <section id="dashboard" class="section active">
                <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
                <div class="dashboard-cards">
                    <div class="card">
                        <h3>Operaciones este mes</h3>
                        <p id="ops-this-month">0</p>
                    </div>
                    <div class="card success">
                        <h3>Operaciones con aviso</h3>
                        <p id="ops-with-notice">0</p>
                    </div>
                    <div class="card warning">
                        <h3>Por vencer (5 días)</h3>
                        <p id="ops-pending">0</p>
                    </div>
                    <div class="card danger">
                        <h3>Vencidas</h3>
                        <p id="ops-expired">0</p>
                    </div>
                </div>

                <h3>Últimas operaciones registradas</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Cliente</th>
                            <th>Tipo de acto</th>
                            <th>Monto</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody id="recent-operations">
                        <!-- Los datos se cargarán dinámicamente -->
                    </tbody>
                </table>
            </section>

            <!-- Nueva Operación -->
            <section id="nueva-operacion" class="section">
                <h2><i class="fas fa-file-contract"></i> Registrar Nueva Operación</h2>
                
                <div class="threshold-info">
                    <h4><i class="fas fa-info-circle"></i> Umbrales de Aviso según SAT</h4>
                    <p>• Compraventa inmuebles: Identificación ≥ 1,605 UMA | Aviso ≥ 8,025 UMA</p>
                    <p>• Constitución de fideicomisos: Aviso ≥ 4,000 UMA</p>
                    <p>• Avalúos: Aviso ≥ 8,025 UMA</p>
                    <p>• Tarjetas de servicios: Identificación ≥ 805 UMA | Aviso ≥ 1,285 UMA</p>
                </div>
                
                <form id="operacion-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="fecha-operacion" class="required">Fecha de la operación:</label>
                            <input type="date" id="fecha-operacion" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="tipo-acto" class="required">Tipo de acto notarial:</label>
                            <select id="tipo-acto" required>
                                <option value="">Seleccione el tipo de acto</option>
                                <option value="compraventa">Compraventa de inmueble</option>
                                <option value="fideicomiso">Constitución de fideicomiso</option>
                                <option value="avaluo">Avalúo</option>
                                <option value="testamento">Testamento</option>
                                <option value="poder">Poder notarial</option>
                                <option value="tarjeta-servicios">Emisión de tarjetas de servicios</option>
                                <option value="otros">Otros actos</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="monto" class="required">Monto de la operación (MXN):</label>
                            <input type="number" id="monto" min="0" step="0.01" required oninput="checkUmbrales()">
                            <div id="umbral-alert"></div>
                        </div>
                        
                        <div class="form-group">
                            <label for="cliente" class="required">Cliente:</label>
                            <select id="cliente" required>
                                <option value="">Seleccione un cliente</option>
                                <!-- Las opciones se cargarán dinámicamente -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="numero-escritura">Número de escritura:</label>
                            <input type="text" id="numero-escritura">
                        </div>
                        
                        <div class="form-group">
                            <label for="partes-involucradas">Partes involucradas:</label>
                            <textarea id="partes-involucradas" rows="3" placeholder="Nombres de las partes involucradas en la operación"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="descripcion">Descripción de la operación:</label>
                        <textarea id="descripcion" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="ppp-check">
                            <input type="checkbox" id="ppp-check"> ¿Es Persona Políticamente Expuesta (PPE)?
                        </label>
                    </div>
                    
                    <div id="ppp-details" class="hidden">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="ppp-cargo">Cargo público:</label>
                                <input type="text" id="ppp-cargo">
                            </div>
                            
                            <div class="form-group">
                                <label for="ppp-periodo">Período en el cargo:</label>
                                <input type="text" id="ppp-periodo" placeholder="Ej: 2020-2024">
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-success">
                        <i class="fas fa-save"></i> Guardar Operación
                    </button>
                </form>
            </section>

            <!-- Operaciones Registradas -->
            <section id="operaciones" class="section">
                <h2><i class="fas fa-clipboard-list"></i> Operaciones Registradas</h2>
                
                <div class="form-group">
                    <input type="text" id="search-operations" placeholder="Buscar operaciones...">
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Cliente</th>
                            <th>Tipo de acto</th>
                            <th>Monto</th>
                            <th>Requiere Aviso</th>
                            <th>PPE</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="operations-list">
                        <!-- Los datos se cargarán dinámicamente -->
                    </tbody>
                </table>
            </section>

            <!-- Clientes y PPE -->
            <section id="clientes" class="section">
                <h2><i class="fas fa-users"></i> Clientes y Personas Políticamente Expuestas (PPE)</h2>
                
                <div class="threshold-info">
                    <h4><i class="fas fa-info-circle"></i> Información sobre PPE según Reforma 2025</h4>
                    <p>• La SHCP mantendrá un listado actualizado de PPE</p>
                    <p>• Incluye funcionarios en activo, exfuncionarios (hasta 3 años después) y familiares directos</p>
                    <p>• Los sujetos obligados deben hacer su propio análisis incluso si no aparecen en el listado</p>
                </div>
                
                <div class="mb-3">
                    <button id="add-client-btn" class="btn-success">
                        <i class="fas fa-user-plus"></i> Agregar Cliente
                    </button>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Identificación</th>
                            <th>Tipo</th>
                            <th>PPE</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="clients-list">
                        <!-- Los datos se cargarán dinámicamente -->
                    </tbody>
                </table>
                
                <h3 class="mt-3">Consultar Listado de PPE</h3>
                <div class="form-group">
                    <button id="check-ppe-btn">
                        <i class="fas fa-search"></i> Consultar con SHCP
                    </button>
                </div>
                <div id="ppe-result" class="hidden">
                    <!-- Resultado de la consulta -->
                </div>
            </section>

            <!-- Configuración -->
            <section id="configuracion" class="section">
                <h2><i class="fas fa-cog"></i> Configuración del Sistema</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="uma-value">Valor de la UMA (MXN):</label>
                        <input type="number" id="uma-value" value="120.36" step="0.01">
                        <small>Este valor se actualiza anualmente. Verifique el valor oficial.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="alert-days">
                            Días de anticipación para recordatorios de avisos:
                        </label>
                        <input type="number" id="alert-days" value="5" min="1" max="30">
                    </div>
                </div>
                
                <h3>Umbrales de Aviso Automático</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="compraventa-threshold">Compraventa de inmuebles (Identificación - UMA):</label>
                        <input type="number" id="compraventa-identificacion-threshold" value="1605" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="compraventa-threshold">Compraventa de inmuebles (Aviso - UMA):</label>
                        <input type="number" id="compraventa-aviso-threshold" value="8025" readonly>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="fideicomiso-threshold">Constitución de fideicomisos (Aviso - UMA):</label>
                        <input type="number" id="fideicomiso-threshold" value="4000" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="avaluo-threshold">Avalúos (Aviso - UMA):</label>
                        <input type="number" id="avaluo-threshold" value="8025" readonly>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="tarjeta-identificacion-threshold">Tarjetas de servicios (Identificación - UMA):</label>
                        <input type="number" id="tarjeta-identificacion-threshold" value="805" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="tarjeta-aviso-threshold">Tarjetas de servicios (Aviso - UMA):</label>
                        <input type="number" id="tarjeta-aviso-threshold" value="1285" readonly>
                    </div>
                </div>
                
                <h3>Datos del Notario</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="notario-nombre" class="required">Nombre completo:</label>
                        <input type="text" id="notario-nombre" value="Juan Pérez" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="notario-numero" class="required">Número de notaría:</label>
                        <input type="text" id="notario-numero" value="123" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="notario-entidad" class="required">Entidad federativa:</label>
                        <input type="text" id="notario-entidad" value="Ciudad de México" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="notario-direccion" class="required">Dirección:</label>
                        <input type="text" id="notario-direccion" value="Av. Reforma 123, CDMX" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="notario-telefono" class="required">Teléfono:</label>
                        <input type="tel" id="notario-telefono" value="5551234567" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="notario-email" class="required">Correo electrónico:</label>
                        <input type="email" id="notario-email" value="juan.perez@notario.com" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="notario-rfc" class="required">RFC:</label>
                    <input type="text" id="notario-rfc" value="PEPJ800101ABC" required>
                </div>
                
                <button id="save-config-btn" class="btn-success">
                    <i class="fas fa-save"></i> Guardar Configuración
                </button>
            </section>
        </main>

        <!-- Modal para Agregar/Editar Cliente -->
        <div id="client-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-user-plus"></i> <span id="modal-client-title">Agregar Nuevo Cliente</span></h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="tabs">
                        <div class="tab active" data-tab="persona-fisica">Persona Física</div>
                        <div class="tab" data-tab="persona-moral">Persona Moral</div>
                    </div>
                    
                    <form id="client-form">
                        <input type="hidden" id="client-id" value="">
                        <input type="hidden" id="client-type" value="fisica">
                        
                        <!-- Persona Física -->
                        <div id="persona-fisica" class="tab-content active">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="nombre" class="required">Nombre(s):</label>
                                    <input type="text" id="nombre" required>
                                </div>
                                <div class="form-group">
                                    <label for="apellido-paterno" class="required">Apellido Paterno:</label>
                                    <input type="text" id="apellido-paterno" required>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="apellido-materno">Apellido Materno:</label>
                                    <input type="text" id="apellido-materno">
                                </div>
                                <div class="form-group">
                                    <label for="rfc" class="required">RFC:</label>
                                    <input type="text" id="rfc" required pattern="^[A-ZÑ&]{3,4}[0-9]{6}[A-Z0-9]{3}$">
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="curp" class="required">CURP:</label>
                                    <input type="text" id="curp" required pattern="^[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9]{2}$">
                                </div>
                                <div class="form-group">
                                    <label for="fecha-nacimiento" class="required">Fecha de Nacimiento:</label>
                                    <input type="date" id="fecha-nacimiento" required>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="nacionalidad" class="required">Nacionalidad:</label>
                                    <input type="text" id="nacionalidad" value="Mexicana" required>
                                </div>
                                <div class="form-group">
                                    <label for="ocupacion" class="required">Ocupación:</label>
                                    <input type="text" id="ocupacion" required>
                                </div>
                            </div>
                            
                            <h3>Datos de Contacto</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="telefono" class="required">Teléfono:</label>
                                    <input type="tel" id="telefono" required>
                                </div>
                                <div class="form-group">
                                    <label for="email" class="required">Correo Electrónico:</label>
                                    <input type="email" id="email" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="domicilio" class="required">Domicilio Completo:</label>
                                <textarea id="domicilio" rows="3" required></textarea>
                            </div>
                            
                            <h3>Documentación</h3>
                            <div id="documentos-fisica">
                                <!-- Lista de documentos -->
                            </div>
                            
                            <div class="file-upload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Arrastre aquí un documento o haga clic para seleccionar</p>
                                <input type="file" id="nuevo-documento-fisica" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                <button type="button" class="btn-outline" onclick="document.getElementById('nuevo-documento-fisica').click()">
                                    <i class="fas fa-file-upload"></i> Agregar Documento
                                </button>
                            </div>
                            
                            <div class="form-group">
                                <label for="ppp-check-modal">
                                    <input type="checkbox" id="ppp-check-modal"> ¿Es Persona Políticamente Expuesta (PPE)?
                                </label>
                            </div>
                        </div>
                        
                        <!-- Persona Moral -->
                        <div id="persona-moral" class="tab-content">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="razon-social" class="required">Razón Social:</label>
                                    <input type="text" id="razon-social" required>
                                </div>
                                <div class="form-group">
                                    <label for="rfc-moral" class="required">RFC:</label>
                                    <input type="text" id="rfc-moral" required pattern="^[A-ZÑ&]{3}[0-9]{6}[A-Z0-9]{3}$">
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="fecha-constitucion" class="required">Fecha de Constitución:</label>
                                    <input type="date" id="fecha-constitucion" required>
                                </div>
                                <div class="form-group">
                                    <label for="objeto-social" class="required">Objeto Social:</label>
                                    <input type="text" id="objeto-social" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="domicilio-moral" class="required">Domicilio Fiscal:</label>
                                <textarea id="domicilio-moral" rows="3" required></textarea>
                            </div>
                            
                            <h3>Representante Legal</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="nombre-representante" class="required">Nombre Completo:</label>
                                    <input type="text" id="nombre-representante" required>
                                </div>
                                <div class="form-group">
                                    <label for="rfc-representante" class="required">RFC:</label>
                                    <input type="text" id="rfc-representante" required pattern="^[A-ZÑ&]{3,4}[0-9]{6}[A-Z0-9]{3}$">
                                </div>
                            </div>
                            
                            <h3>Datos de Contacto</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="telefono-moral" class="required">Teléfono:</label>
                                    <input type="tel" id="telefono-moral" required>
                                </div>
                                <div class="form-group">
                                    <label for="email-moral" class="required">Correo Electrónico:</label>
                                    <input type="email" id="email-moral" required>
                                </div>
                            </div>
                            
                            <h3>Beneficiario Controlador</h3>
                            <div class="beneficiary-section">
                                <div class="beneficiary-header">
                                    <h4>Información del Beneficiario Controlador</h4>
                                    <button type="button" class="btn-outline" id="add-beneficiary-btn">
                                        <i class="fas fa-plus"></i> Agregar
                                    </button>
                                </div>
                                
                                <div id="beneficiarios-list">
                                    <!-- Lista de beneficiarios -->
                                </div>
                            </div>
                            
                            <h3>Documentación</h3>
                            <div id="documentos-moral">
                                <!-- Lista de documentos -->
                            </div>
                            
                            <div class="file-upload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Arrastre aquí un documento o haga clic para seleccionar</p>
                                <input type="file" id="nuevo-documento-moral" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                <button type="button" class="btn-outline" onclick="document.getElementById('nuevo-documento-moral').click()">
                                    <i class="fas fa-file-upload"></i> Agregar Documento
                                </button>
                            </div>
                            
                            <div class="form-group">
                                <label for="ppp-check-moral">
                                    <input type="checkbox" id="ppp-check-moral"> ¿Es Persona Políticamente Expuesta (PPE)?
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-outline close-modal">Cancelar</button>
                    <button type="button" id="save-client-btn" class="btn-success">Guardar Cliente</button>
                </div>
            </div>
        </div>

        <!-- Modal para Beneficiario Controlador -->
        <div id="beneficiary-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-user-tie"></i> Agregar Beneficiario Controlador</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="beneficiary-form">
                        <input type="hidden" id="beneficiary-id" value="">
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="beneficiary-nombre" class="required">Nombre(s):</label>
                                <input type="text" id="beneficiary-nombre" required>
                            </div>
                            <div class="form-group">
                                <label for="beneficiary-apellido-paterno" class="required">Apellido Paterno:</label>
                                <input type="text" id="beneficiary-apellido-paterno" required>
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="beneficiary-apellido-materno">Apellido Materno:</label>
                                <input type="text" id="beneficiary-apellido-materno">
                            </div>
                            <div class="form-group">
                                <label for="beneficiary-rfc" class="required">RFC:</label>
                                <input type="text" id="beneficiary-rfc" required pattern="^[A-ZÑ&]{3,4}[0-9]{6}[A-Z0-9]{3}$">
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="beneficiary-curp" class="required">CURP:</label>
                                <input type="text" id="beneficiary-curp" required pattern="^[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9]{2}$">
                            </div>
                            <div class="form-group">
                                <label for="beneficiary-nacionalidad" class="required">Nacionalidad:</label>
                                <input type="text" id="beneficiary-nacionalidad" value="Mexicana" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="beneficiary-participacion" class="required">Porcentaje de Participación:</label>
                            <input type="number" id="beneficiary-participacion" min="0" max="100" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="beneficiary-domicilio" class="required">Domicilio:</label>
                            <textarea id="beneficiary-domicilio" rows="3" required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-outline close-modal">Cancelar</button>
                    <button type="button" id="save-beneficiary-btn" class="btn-success">Guardar Beneficiario</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
</body>
</html>